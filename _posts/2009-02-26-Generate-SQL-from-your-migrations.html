---
layout: post
title: Generate SQL from your migrations
date: 2009-02-26 17:29:29 UTC
updated: 2009-02-26 17:29:29 UTC
comments: false
categories: rails plugin sql migrations
---
<p>
On one of the projects <a href="http://thinkrelevance.com">we</a>'re working on, we needed to occassionaly generate SQL from our migrations.  Déjà vu, I thought.  A few minutes of Googling later, I <a href="http://blog.jayfields.com/2006/11/rails-generate-sql-from-migrations.html">remembered why</a>: Jay and I had been on a project a couple of years ago whence we had the same need.  Jay's code didn't quite work any more due to some ActiveRecord changes, and a search for an alternative implementation turned up nothing.
</p>
<p>
I took his code and modified it to our needs.  A short time later, I had the code pulled out into a rails plugin, <a href="http://github.com/muness/migration_sql_generator">migration_sql_generator</a>.  Install it (<code>script/plugin install git://github.com/muness/migration_sql_generator.git</code>) and then run the rake task:
<code>
<pre>
rake db:generate:migration_sql
</pre>
</code>
</p>
<p>Running this task generates two sql files per migration in <code>db/migration_sql</code> in the form <code>20090216224354_add_users.sql</code> and <code>20090216224354_add_users_down.sql</code>.
</p>
<p>
I've used the plugin with success using the sqlserver adapter, less luck with the mysql adapter (change_column and rename_column blow up because the mysql adapter checks for the presence of a column first) and no luck with the sqlite adapter.  Haven't tried it with the postgres adapter.
</p>